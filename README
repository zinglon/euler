Needless to say, you shouldn't read any solution until you've solved the problem yourself.
Feel free to do whatever you want with these bits of code. I make no claim that any solution is great, but they work.